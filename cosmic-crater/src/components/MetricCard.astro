---
import MetricIcon from "./MetricIcon.astro";

interface Props {
  title?: string;             
  icon?: "cash" | "pie" | "search" | "tag";

  value?: string;             // big number text, e.g., "$74.8B"
  caption?: string;           // small line under value

  deltaText?: string;         // "+14.6% YoY compared to $65.3B"
  deltaSign?: "up" | "down" | "neutral"; // colorizes the ribbon

  // theming
  cardBg?: string;            // main teal block
  ink?: string;               // text color on card
  ribbonBg?: string;          // bottom ribbon base color
  upColor?: string;           // positive delta
  downColor?: string;         // negative delta

  // layout
  iconSize?: string;          // px
  radius?: string;
  padding?: string;
  minHeight?: string;
}

const {
  title = "Metric",
  icon = "cash",
  value = "â€”",
  caption = "",
  deltaText = "",
  deltaSign = "neutral",

  cardBg = "#7FBFC6",
  ink = "#0E6A73",       
  ribbonBg = "#FFFFFF",  // pure white bottom strip
  upColor = "#0E6A73",   // teal for + numbers
  downColor = "#9A3D3D",

  iconSize = "96",
  radius = "12px",
  padding = "28px",
  minHeight = "220px",
} = Astro.props as Props;

const signClass = deltaSign === "up" ? "up" : deltaSign === "down" ? "down" : "neutral";
---

<article
  class="card"
  style={`--bg:${cardBg}; --ink:${ink}; --rib:${ribbonBg}; --up:${upColor}; --down:${downColor};
          --r:${radius}; --p:${padding}; --minh:${minHeight};`}
  role="group"
  aria-label={title}
>
  <header class="head">
    <h4 class="title">{title}</h4>
  </header>

  <div class="art">
    <MetricIcon name={icon} size={iconSize} color="currentColor" strokeWidth={3}/>
  </div>

  <div class="stat">
    <div class="value">{value}</div>
    {caption && <p class="caption">{caption}</p>}
  </div>

  {deltaText && (
    <footer class={`ribbon ${signClass}`} aria-live="polite">
      {deltaText}
    </footer>
  )}
</article>

<style>
  .card{
    background: var(--bg);
    color: var(--ink);
    border-radius: var(--r);
    padding: var(--p);
    display: grid;
    grid-template-rows: auto 1fr auto auto;
    gap: 12px;
    min-height: var(--minh);
    box-shadow: 0 2px 0 rgba(0,0,0,.06) inset;
    display: flex;
    flex-direction: column;
    align-items: center;     
    justify-content: center;  
    text-align: center;       
    gap: 12px; 
  }
  .head .title{
    margin: 0;
    font: 700 24px/1.15 Inter, system-ui, sans-serif;
    letter-spacing: .02em;
    font-weight: 600;
  }
  .art{
    display: grid;
    place-items: center;
    color: color-mix(in srgb, var(--ink) 85%, transparent);
  }
  .value{
    margin: 0;
    font: 800 56px/1.05 "PPRightGroteskWide", Inter, system-ui, sans-serif;
    letter-spacing: .01em;
  }
  .caption{
    margin: 10px 0 0;
    font: 600 16px/1.3 Inter, system-ui, sans-serif;
    opacity: .9;
  }

  /* bottom ribbon */
  .ribbon{
    padding: 14px 16px;
    border-radius: 8px;
    background: var(--rib);
    font: 700 14px/1.2 Inter, system-ui, sans-serif;
    letter-spacing: .01em;
  }
  .ribbon.up{ color: var(--up); }
  .ribbon.down{ color: var(--down); }
  .ribbon.neutral{ color: var(--ink); }

  @media (max-width: 720px){
    .value{ font-size: 44px; }
    .head .title{ font-size: 20px; }
  }
  
</style>
